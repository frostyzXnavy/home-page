<!DOCTYPE html>
<html>
<head>
  <title>Zero Violet Tab</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
  <style>
    :root { --main: #eeeeee; --alt: #1d81b2; --bg: #1a1a1a; }
    html, body { height: 100%; margin: 0; background: var(--bg); overflow: hidden; position: relative; }
    
    body::before {
      content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
      background: url('https://grainy-gradients.vercel.app/noise.svg');
      opacity: 0.04; pointer-events: none; animation: noise 0.2s infinite;
    }
    @keyframes noise {
      0% { transform: translate(0,0) } 10% { transform: translate(-1%,-1%) }
      20% { transform: translate(1%,1%) } 100% { transform: translate(0,0) }
    }

    body { display: flex; font: 18px "Courier New", Courier, monospace; color: var(--main); z-index: 1; }
    
    /* Sidebar Layout */
    .sidebar { display: flex; flex-direction: column; padding: 2em; width: 280px; border-right: 1px solid #333; height: 100vh; box-sizing: border-box; flex-shrink: 0; background: var(--bg); transition: all 0.3s ease; }
    h1 { font-size: 1.1em; margin: 0; text-transform: lowercase; letter-spacing: 1px; }
    .status-row { display: flex; gap: 10px; font-size: 0.6em; opacity: 0.5; margin-bottom: 2em; margin-top: 8px; }
    
    ul { list-style: none; padding: 0; margin-bottom: 1.5em; overflow-y: auto; }
    li { line-height: 1.8em; font-size: 0.9em; }
    li.head { font-weight: bold; margin-bottom: 0.5em; text-transform: uppercase; letter-spacing: 1px; font-size: 0.8em; opacity: 1; }
    a { color: inherit; text-decoration: none; cursor: pointer; }
    a:hover { color: var(--alt); }
    
    .separator { border-top: 1px solid #333; margin: 1em 0; width: 40%; }
    .notes-container { display: flex; flex-direction: column; margin-bottom: 1em; flex-grow: 1; min-height: 100px; }
    textarea { flex-grow: 1; background: repeating-linear-gradient(transparent, transparent 30px, #333 30px, #333 31px); border: none; outline: none; color: var(--main); font-family: inherit; font-size: 0.9em; resize: none; width: 100%; line-height: 31px; }
    
    .cal-container { margin-top: 1em; margin-bottom: 1em; font-size: 0.6em; width: 100%; opacity: 0.6; }
    .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); text-align: center; row-gap: 8px; }
    .today { color: var(--alt); font-weight: bold; opacity: 1; }

    .exam-countdown { font-size: 0.55em; letter-spacing: 1px; color: var(--alt); text-align: center; border-top: 1px solid #333; padding-top: 1.5em; white-space: nowrap; }

    /* Main Content & PDF Toggle */
    .main-content { flex-grow: 1; display: flex; align-items: center; justify-content: center; position: relative; padding: 20px; }
    
    #griffith-view { display: flex; flex-direction: column; align-items: flex-end; padding-right: 10%; width: 100%; }
    .img-wrap { width: 12em; display: flex; flex-direction: column; }
    img { border: 1px solid rgba(255,255,255,0.2); width: 100%; height: 18em; object-fit: cover; }
    
    #pdf-view { display: none; width: 100%; height: 100%; flex-direction: column; align-items: center; }
    #drop-zone { width: 80%; height: 200px; border: 1px dashed #444; display: flex; align-items: center; justify-content: center; color: #666; font-size: 0.8em; margin-top: 20%; }
    #pdf-render-container { width: 100%; height: 100%; overflow-y: auto; display: none; background: #111; padding: 20px 0; }
    canvas { display: block; margin: 0 auto 20px auto; box-shadow: 0 0 20px rgba(0,0,0,0.5); }

    /* The Switch Arrow */
    #view-toggle { position: absolute; right: 30px; top: 50%; transform: translateY(-50%); font-size: 2em; cursor: pointer; opacity: 0.3; transition: opacity 0.3s; z-index: 10; }
    #view-toggle:hover { opacity: 1; color: var(--alt); }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="sidebar">
    <h1 id="greeting">still at it.</h1>
    <div class="status-row">
        <div id="weather">--°C</div>
        <div id="timer">00:00</div>
    </div>
    
    <div id="menu-general">
        <ul>
          <li class="head">General</li>
          <li><a href="https://www.youtube.com/">Playlist</a></li>
          <li><a href="https://gemini.google.com/">Gemini</a></li>
          <li><a href="https://www.instagram.com/">Instagram</a></li>
        </ul>
    </div>

    <div id="menu-toc" class="hidden">
        <li class="head">Table of Contents</li>
        <ul id="toc-list">
          <li style="opacity:0.5">No file loaded...</li>
        </ul>
    </div>

    <div class="separator"></div>
    <div class="notes-container"><textarea id="notes-area" spellcheck="false"></textarea></div>
    <div class="separator"></div>
    
    <div class="cal-container">
      <div id="cal-month" style="font-weight:bold; margin-bottom:12px; text-transform:uppercase;"></div>
      <div class="cal-grid" id="calendar">
        <div class="day-name">S</div><div class="day-name">M</div><div class="day-name">T</div><div class="day-name">W</div><div class="day-name">T</div><div class="day-name">F</div><div class="day-name">S</div>
      </div>
    </div>

    <div class="exam-countdown" id="exam-cd">[ 14 DAYS UNTIL FEB 17 ]</div>
  </div>

  <div class="main-content">
      <div id="view-toggle" onclick="toggleView()">→</div>

      <div id="griffith-view">
          <div class="img-wrap">
              <img src="griffith.png" alt="Griffith">
              <div style="margin-top:1.2em; font-size:0.7em; font-weight:bold; opacity:0.6;">
                  <div>For they are dead</div>
                  <div>because they have no dreams</div>
              </div>
          </div>
      </div>

      <div id="pdf-view">
          <div id="drop-zone">DROP PDF HERE</div>
          <div id="pdf-render-container"></div>
      </div>
  </div>

  <script>
    let isPdfMode = false;
    const pdfjsLib = window['pdfjs-dist/build/pdf'];
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    function toggleView() {
        isPdfMode = !isPdfMode;
        document.getElementById('griffith-view').style.display = isPdfMode ? 'none' : 'flex';
        document.getElementById('pdf-view').style.display = isPdfMode ? 'flex' : 'none';
        document.getElementById('menu-general').classList.toggle('hidden', isPdfMode);
        document.getElementById('menu-toc').classList.toggle('hidden', !isPdfMode);
        document.getElementById('view-toggle').innerText = isPdfMode ? '←' : '→';
    }

    // PDF Drag and Drop Logic
    const dropZone = document.getElementById('drop-zone');
    dropZone.ondragover = (e) => { e.preventDefault(); dropZone.style.borderColor = var(--alt); };
    dropZone.ondrop = (e) => {
        e.preventDefault();
        const file = e.dataTransfer.files[0];
        if (file && file.type === "application/pdf") {
            loadPDF(file);
        }
    };

    async function loadPDF(file) {
        const reader = new FileReader();
        reader.onload = async function() {
            const typedarray = new Uint8Array(this.result);
            const pdf = await pdfjsLib.getDocument(typedarray).promise;
            
            dropZone.classList.add('hidden');
            const container = document.getElementById('pdf-render-container');
            container.style.display = 'block';
            container.innerHTML = '';

            // Render all pages
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const viewport = page.getViewport({ scale: 1.5 });
                const canvas = document.createElement('canvas');
                const context = canvas.getContext('2d');
                canvas.height = viewport.height;
                canvas.width = viewport.width;
                container.appendChild(canvas);
                await page.render({ canvasContext: context, viewport: viewport }).promise;
            }

            // Extract TOC (Outline)
            const outline = await pdf.getOutline();
            const tocList = document.getElementById('toc-list');
            tocList.innerHTML = '';
            
            if (outline && outline.length > 0) {
                outline.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<a>${item.title}</a>`;
                    tocList.appendChild(li);
                });
            } else {
                tocList.innerHTML = '<li>No TOC found</li>';
            }
        };
        reader.readAsArrayBuffer(file);
    }

    // Standard Calendar/Weather/Notes logic
    const na = document.getElementById('notes-area');
    na.value = localStorage.getItem('sazi_notes') || "";
    na.oninput = () => localStorage.setItem('sazi_notes', na.value);
    
    // Initialize Calendar for Feb 2026 based on image
    const now = new Date();
    document.getElementById('cal-month').innerText = "FEBRUARY 2026";
    const grid = document.getElementById('calendar');
    // Feb 2026 starts on a Sunday (0)
    let html = '<div></div>'.repeat(0); 
    for (let d = 1; d <= 28; d++) {
        html += `<div class="${d === 3 ? 'today' : ''}">${d}</div>`;
    }
    grid.innerHTML += html;
  </script>
</body>
</html>
